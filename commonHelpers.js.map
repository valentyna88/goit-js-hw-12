{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\naxios.defaults.baseURL = 'https://pixabay.com/api/';\n\nexport const fetchImages = (searchedQuery, page) => {\n  const axiosOptions = {\n    params: {\n      q: searchedQuery,\n      image_type: 'photo',\n      orientation: 'horizontal',\n      safesearch: true,\n      per_page: 15,\n      key: '45452240-d9bf2a206a145f9e2645b735d',\n      page,\n    },\n  };\n\n  return axios.get('', axiosOptions);\n};\n","export const renderImages = images => {\n  return images\n    .map(\n      ({\n        largeImageURL,\n        webformatURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) => `\n    <div class=\"image-container\">\n      <li class=\"gallery-item\">\n        <div class=\"image-viewer\">\n          <a class=\"gallery-link\" href=\"${largeImageURL}\">\n            <img class=\"gallery-image\" src=\"${webformatURL}\" alt=\"${tags}\" loading=\"lazy\" />\n          </a>\n        </div>\n        <ul class=\"gallery-info-list\">\n          <li class=\"gallery-info-item\">\n            <h3>Likes</h3>\n            <p>${likes}</p>\n          </li>\n          <li class=\"gallery-info-item\">\n            <h3>Views</h3>\n            <p>${views}</p>\n          </li>\n          <li class=\"gallery-info-item\">\n            <h3>Comments</h3>\n            <p>${comments}</p>\n          </li>\n          <li class=\"gallery-info-item\">\n            <h3>Downloads</h3>\n            <p>${downloads}</p>\n          </li>\n        </ul>\n      </li>\n    </div>\n  `\n    )\n    .join('');\n};\n","import iziToast from 'izitoast';\nimport SimpleLightbox from 'simplelightbox';\nimport { fetchImages } from './js/pixabay-api';\nimport { renderImages } from './js/render-functions';\n\nconst searchFormEl = document.querySelector('.js-search-form');\nconst gallery = document.querySelector('.js-gallery');\nconst loader = document.querySelector('.js-loader');\nconst loadBtn = document.querySelector('.js-load-btn');\n\nlet lightbox = new SimpleLightbox('.js-gallery a');\n\nlet searchedValue = '';\nlet page = 1;\nlet totalHits = 0;\nconst perPage = 15;\n\nconst showLoader = () => loader.classList.remove('is-hidden');\nconst hideLoader = () => loader.classList.add('is-hidden');\nconst showLoadBtn = () => loadBtn.classList.remove('is-hidden');\nconst hideLoadBtn = () => loadBtn.classList.add('is-hidden');\n\nconst smoothScroll = () => {\n  const { height: cardHeight } = document\n    .querySelector('.gallery-item')\n    .getBoundingClientRect();\n\n  window.scrollBy({\n    top: cardHeight * 2,\n    behavior: 'smooth',\n  });\n};\n\nconst fetchAndRenderImages = async (isNewSearch = false) => {\n  try {\n    const response = await fetchImages(searchedValue, page);\n\n    if (response.data.hits.length === 0) {\n      iziToast.error({\n        message:\n          'Sorry, there are no images matching your search query. Please try again!',\n        position: 'topRight',\n      });\n      if (isNewSearch) gallery.innerHTML = '';\n      hideLoadBtn();\n      return false;\n    }\n\n    if (isNewSearch) {\n      totalHits = response.data.totalHits; // Обновляем общее количество изображений при новом поиске\n      gallery.innerHTML = renderImages(response.data.hits);\n    } else {\n      gallery.insertAdjacentHTML('beforeend', renderImages(response.data.hits));\n    }\n\n    page++;\n    lightbox.refresh();\n\n    const totalPages = Math.ceil(totalHits / perPage);\n\n    if (page > totalPages) {\n      hideLoadBtn();\n      iziToast.info({\n        message: \"We're sorry, but you've reached the end of search results.\",\n        position: 'topRight',\n      });\n    } else {\n      showLoadBtn();\n    }\n\n    if (!isNewSearch) {\n      smoothScroll();\n    }\n\n    return true;\n  } catch (error) {\n    console.error('Fetch Error:', error);\n    iziToast.error({\n      message: 'Failed to fetch images. Please try again later.',\n      position: 'topRight',\n    });\n    return false;\n  } finally {\n    hideLoader();\n  }\n};\n\nconst onSearchFormSubmit = async event => {\n  event.preventDefault();\n  page = 1;\n\n  searchedValue = searchFormEl.elements.user_query.value.trim();\n\n  if (searchedValue === '') {\n    iziToast.error({\n      message: 'Please enter a search query!',\n      position: 'topRight',\n    });\n    return;\n  }\n  showLoader();\n  hideLoadBtn();\n  const success = await fetchAndRenderImages(true);\n  searchFormEl.reset();\n};\n\nconst onLoadMoreClick = async () => {\n  showLoader();\n  hideLoadBtn();\n  await fetchAndRenderImages();\n};\n\nsearchFormEl.addEventListener('submit', onSearchFormSubmit);\nloadBtn.addEventListener('click', onLoadMoreClick);\n"],"names":["axios","fetchImages","searchedQuery","page","axiosOptions","renderImages","images","largeImageURL","webformatURL","tags","likes","views","comments","downloads","searchFormEl","gallery","loader","loadBtn","lightbox","SimpleLightbox","searchedValue","totalHits","perPage","showLoader","hideLoader","showLoadBtn","hideLoadBtn","smoothScroll","cardHeight","fetchAndRenderImages","isNewSearch","response","iziToast","totalPages","error","onSearchFormSubmit","event","onLoadMoreClick"],"mappings":"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"}