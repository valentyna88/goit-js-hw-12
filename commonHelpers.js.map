{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\naxios.defaults.baseURL = 'https://pixabay.com/api/';\n\nexport const fetchImages = (searchedQuery, page) => {\n  const axiosOptions = {\n    params: {\n      q: searchedQuery,\n      image_type: 'photo',\n      orientation: 'horizontal',\n      safesearch: true,\n      per_page: 15,\n      key: '45452240-d9bf2a206a145f9e2645b735d',\n      page,\n    },\n  };\n\n  return axios.get(``, axiosOptions);\n};\n","export const renderImages = images => {\n  return images\n    .map(\n      ({\n        largeImageURL,\n        webformatURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) => `\n    <div class=\"image-container\">\n      <li class=\"gallery-item\">\n        <div class=\"image-viewer\">\n          <a class=\"gallery-link\" href=\"${largeImageURL}\">\n            <img class=\"gallery-image\" src=\"${webformatURL}\" alt=\"${tags}\" loading=\"lazy\" />\n          </a>\n        </div>\n        <ul class=\"gallery-info-list\">\n          <li class=\"gallery-info-item\">\n            <h3>Likes</h3>\n            <p>${likes}</p>\n          </li>\n          <li class=\"gallery-info-item\">\n            <h3>Views</h3>\n            <p>${views}</p>\n          </li>\n          <li class=\"gallery-info-item\">\n            <h3>Comments</h3>\n            <p>${comments}</p>\n          </li>\n          <li class=\"gallery-info-item\">\n            <h3>Downloads</h3>\n            <p>${downloads}</p>\n          </li>\n        </ul>\n      </li>\n    </div>\n  `\n    )\n    .join('');\n};\n","import iziToast from 'izitoast';\nimport SimpleLightbox from 'simplelightbox';\nimport { fetchImages } from './js/pixabay-api';\nimport { renderImages } from './js/render-functions';\n\n// Отримуємо посилання на елементи DOM\nconst searchFormEl = document.querySelector('.js-search-form');\nconst gallery = document.querySelector('.js-gallery');\nconst loader = document.querySelector('.loader');\nconst loadBtn = document.querySelector('.load-btn');\n\n// Ініціалізація SimpleLightbox для галереї\nlet lightbox = new SimpleLightbox('.js-gallery a');\n\n// Глобальні змінні для зберігання пошукового запиту та поточної сторінки\nlet searchedValue = '';\nlet page = 1;\nlet totalHits = 0; // Додаємо змінну для зберігання загальної кількості зображень\nconst perPage = 15; // Кількість зображень на сторінку\n\n// Функції для керування видимістю завантажувача та кнопки \"Load more\"\nconst showLoader = () => loader.classList.remove('is-hidden');\nconst hideLoader = () => loader.classList.add('is-hidden');\nconst showLoadBtn = () => loadBtn.classList.remove('is-hidden');\nconst hideLoadBtn = () => loadBtn.classList.add('is-hidden');\n\n// Функція для обробки запитів до API та рендерингу зображень\nconst fetchAndRenderImages = async (isNewSearch = false) => {\n  try {\n    const response = await fetchImages(searchedValue, page);\n\n    if (response.data.hits.length === 0) {\n      iziToast.error({\n        message:\n          'Sorry, there are no images matching your search query. Please try again!',\n        position: 'topRight',\n      });\n      if (isNewSearch) gallery.innerHTML = '';\n      return false;\n    }\n\n    if (isNewSearch) {\n      totalHits = response.data.totalHits; // Оновлюємо загальну кількість зображень при новому пошуку\n      gallery.innerHTML = renderImages(response.data.hits);\n    } else {\n      gallery.insertAdjacentHTML('beforeend', renderImages(response.data.hits));\n    }\n\n    page += 1;\n    lightbox.refresh();\n\n    // Перевіряємо, чи досягнуто кінця колекції\n    const totalPages = Math.ceil(totalHits / perPage);\n    if (page > totalPages) {\n      hideLoadBtn();\n      iziToast.info({\n        message: \"We're sorry, but you've reached the end of search results.\",\n        position: 'topRight',\n      });\n    } else {\n      showLoadBtn();\n    }\n\n    return true;\n  } catch (error) {\n    console.error(error);\n    iziToast.error({\n      message: 'Failed to fetch images. Please try again later.',\n      position: 'topRight',\n    });\n    return false;\n  } finally {\n    hideLoader();\n  }\n};\n\n// Обробник події відправки форми пошуку\nconst onSearchFormSubmit = async event => {\n  event.preventDefault();\n  page = 1; // Скидання сторінки на 1 при новому пошуковому запиті\n\n  searchedValue = searchFormEl.elements.user_query.value.trim();\n\n  if (searchedValue === '') {\n    iziToast.error({\n      message: 'Please enter a search query!',\n      position: 'topRight',\n    });\n    return;\n  }\n\n  showLoader();\n  hideLoadBtn();\n\n  const success = await fetchAndRenderImages(true);\n  searchFormEl.reset(); // Скидання форми незалежно від результату\n};\n\n// Обробник події кліку по кнопці \"Load more\"\nconst onLoadMoreClick = async () => {\n  showLoader();\n  hideLoadBtn();\n\n  await fetchAndRenderImages();\n};\n\n// Додаємо обробники подій для форми пошуку та кнопки \"Load more\"\nsearchFormEl.addEventListener('submit', onSearchFormSubmit);\nloadBtn.addEventListener('click', onLoadMoreClick);\n"],"names":["axios","fetchImages","searchedQuery","page","axiosOptions","renderImages","images","largeImageURL","webformatURL","tags","likes","views","comments","downloads","searchFormEl","gallery","loader","loadBtn","lightbox","SimpleLightbox","searchedValue","totalHits","perPage","showLoader","hideLoader","showLoadBtn","hideLoadBtn","fetchAndRenderImages","isNewSearch","response","iziToast","totalPages","error","onSearchFormSubmit","event","onLoadMoreClick"],"mappings":"owBAEAA,EAAM,SAAS,QAAU,2BAElB,MAAMC,EAAc,CAACC,EAAeC,IAAS,CAClD,MAAMC,EAAe,CACnB,OAAQ,CACN,EAAGF,EACH,WAAY,QACZ,YAAa,aACb,WAAY,GACZ,SAAU,GACV,IAAK,qCACL,KAAAC,CACD,CACL,EAEE,OAAOH,EAAM,IAAI,GAAII,CAAY,CACnC,EClBaC,EAAeC,GACnBA,EACJ,IACC,CAAC,CACC,cAAAC,EACA,aAAAC,EACA,KAAAC,EACA,MAAAC,EACA,MAAAC,EACA,SAAAC,EACA,UAAAC,CACR,IAAY;AAAA;AAAA;AAAA;AAAA,0CAI8BN,CAAa;AAAA,8CACTC,CAAY,UAAUC,CAAI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,iBAMvDC,CAAK;AAAA;AAAA;AAAA;AAAA,iBAILC,CAAK;AAAA;AAAA;AAAA;AAAA,iBAILC,CAAQ;AAAA;AAAA;AAAA;AAAA,iBAIRC,CAAS;AAAA;AAAA;AAAA;AAAA;AAAA,GAMrB,EACA,KAAK,EAAE,ECnCNC,EAAe,SAAS,cAAc,iBAAiB,EACvDC,EAAU,SAAS,cAAc,aAAa,EAC9CC,EAAS,SAAS,cAAc,SAAS,EACzCC,EAAU,SAAS,cAAc,WAAW,EAGlD,IAAIC,EAAW,IAAIC,EAAe,eAAe,EAG7CC,EAAgB,GAChBjB,EAAO,EACPkB,EAAY,EAChB,MAAMC,EAAU,GAGVC,EAAa,IAAMP,EAAO,UAAU,OAAO,WAAW,EACtDQ,EAAa,IAAMR,EAAO,UAAU,IAAI,WAAW,EACnDS,EAAc,IAAMR,EAAQ,UAAU,OAAO,WAAW,EACxDS,EAAc,IAAMT,EAAQ,UAAU,IAAI,WAAW,EAGrDU,EAAuB,MAAOC,EAAc,KAAU,CAC1D,GAAI,CACF,MAAMC,EAAW,MAAM5B,EAAYmB,EAAejB,CAAI,EAEtD,GAAI0B,EAAS,KAAK,KAAK,SAAW,EAChC,OAAAC,EAAS,MAAM,CACb,QACE,2EACF,SAAU,UAClB,CAAO,EACGF,IAAab,EAAQ,UAAY,IAC9B,GAGLa,GACFP,EAAYQ,EAAS,KAAK,UAC1Bd,EAAQ,UAAYV,EAAawB,EAAS,KAAK,IAAI,GAEnDd,EAAQ,mBAAmB,YAAaV,EAAawB,EAAS,KAAK,IAAI,CAAC,EAG1E1B,GAAQ,EACRe,EAAS,QAAO,EAGhB,MAAMa,EAAa,KAAK,KAAKV,EAAYC,CAAO,EAChD,OAAInB,EAAO4B,GACTL,IACAI,EAAS,KAAK,CACZ,QAAS,6DACT,SAAU,UAClB,CAAO,GAEDL,IAGK,EACR,OAAQO,EAAO,CACd,eAAQ,MAAMA,CAAK,EACnBF,EAAS,MAAM,CACb,QAAS,kDACT,SAAU,UAChB,CAAK,EACM,EACX,QAAY,CACRN,GACD,CACH,EAGMS,EAAqB,MAAMC,GAAS,CAMxC,GALAA,EAAM,eAAc,EACpB/B,EAAO,EAEPiB,EAAgBN,EAAa,SAAS,WAAW,MAAM,KAAI,EAEvDM,IAAkB,GAAI,CACxBU,EAAS,MAAM,CACb,QAAS,+BACT,SAAU,UAChB,CAAK,EACD,MACD,CAEDP,IACAG,IAEgB,MAAMC,EAAqB,EAAI,EAC/Cb,EAAa,MAAK,CACpB,EAGMqB,EAAkB,SAAY,CAClCZ,IACAG,IAEA,MAAMC,EAAoB,CAC5B,EAGAb,EAAa,iBAAiB,SAAUmB,CAAkB,EAC1DhB,EAAQ,iBAAiB,QAASkB,CAAe"}