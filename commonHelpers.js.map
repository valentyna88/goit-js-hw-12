{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\naxios.defaults.baseURL = 'https://pixabay.com/api/';\n\nexport const fetchImages = async (searchedQuery, page) => {\n  const axiosOptions = {\n    params: {\n      q: searchedQuery,\n      image_type: 'photo',\n      orientation: 'horizontal',\n      safesearch: true,\n      page: page,\n      per_page: 15,\n      key: '45452240-d9bf2a206a145f9e2645b735d',\n    },\n  };\n\n  const response = await axios.get('', axiosOptions);\n  return response.data;\n};\n","export const createGalleryCardTemplate = ({\n  largeImageURL,\n  webformatURL,\n  tags,\n  likes,\n  views,\n  comments,\n  downloads,\n}) => `\n  <div class=\"image-container\">\n    <li class=\"gallery-item\">\n      <div class=\"image-viewer\">\n        <a class=\"gallery-link\" href=\"${largeImageURL}\">\n          <img class=\"gallery-image\" src=\"${webformatURL}\" alt=\"${tags}\" loading=\"lazy\" />\n        </a>\n      </div>\n      <ul class=\"gallery-info-list\">\n        <li class=\"gallery-info-item\"><h3>Likes</h3><p>${likes}</p></li>\n        <li class=\"gallery-info-item\"><h3>Views</h3><p>${views}</p></li>\n        <li class=\"gallery-info-item\"><h3>Comments</h3><p>${comments}</p></li>\n        <li class=\"gallery-info-item\"><h3>Downloads</h3><p>${downloads}</p></li>\n      </ul>\n    </li>\n  </div>\n`;\n","import iziToast from 'izitoast';\nimport SimpleLightbox from 'simplelightbox';\nimport { fetchImages } from './js/pixabay-api';\nimport { createGalleryCardTemplate } from './js/render-functions';\n\nconst searchFormEl = document.querySelector('.js-search-form');\nconst galleryEl = document.querySelector('.js-gallery');\nconst loader = document.querySelector('.js-loader');\nconst loadMoreBtnEl = document.querySelector('.js-load-btn');\nlet lightbox = new SimpleLightbox('.js-gallery a', { captionsData: 'alt' });\n\nlet currentPage = 1;\nlet searchedValue = '';\nlet cardHeight = 0;\nconst perPage = 15;\n\nconst renderGallery = images => {\n  const galleryCardsTemplate = images\n    .map(imgDetails => createGalleryCardTemplate(imgDetails))\n    .join('');\n\n  galleryEl.insertAdjacentHTML('beforeend', galleryCardsTemplate);\n\n  const galleryCardEl = galleryEl.querySelector('li');\n  if (galleryCardEl) {\n    cardHeight = galleryCardEl.getBoundingClientRect().height;\n  }\n\n  lightbox.refresh();\n};\n\nconst checkEndOfResults = totalHits => {\n  const totalPages = Math.ceil(totalHits / perPage);\n  if (currentPage >= totalPages) {\n    loadMoreBtnEl.classList.add('is-hidden');\n    iziToast.info({\n      message: \"We're sorry, but you've reached the end of search results.\",\n      position: 'topRight',\n    });\n  } else {\n    loadMoreBtnEl.classList.remove('is-hidden');\n  }\n};\n\nconst onSearchFormSubmit = async event => {\n  try {\n    event.preventDefault();\n\n    searchedValue = searchFormEl.elements.user_query.value.trim();\n    currentPage = 1;\n\n    if (searchedValue === '') {\n      iziToast.error({\n        title: 'Error',\n        message: 'Please enter a search term.',\n        position: 'topRight',\n      });\n      return;\n    }\n\n    loader.classList.remove('is-hidden');\n\n    const data = await fetchImages(searchedValue, currentPage);\n\n    if (data.hits.length === 0) {\n      iziToast.error({\n        message:\n          'Sorry, there are no images matching your search query. Please try again!',\n        position: 'topRight',\n      });\n\n      galleryEl.innerHTML = '';\n      searchFormEl.reset();\n      loadMoreBtnEl.classList.add('is-hidden');\n      return;\n    }\n\n    galleryEl.innerHTML = '';\n    renderGallery(data.hits);\n    checkEndOfResults(data.totalHits);\n  } catch (err) {\n    iziToast.error({\n      message:\n        'An error occurred while fetching images. Please try again later.',\n      position: 'topRight',\n    });\n  } finally {\n    loader.classList.add('is-hidden');\n  }\n};\n\nconst onLoadMoreBtnClick = async () => {\n  try {\n    currentPage++;\n\n    const data = await fetchImages(searchedValue, currentPage);\n    renderGallery(data.hits);\n\n    window.scrollBy({\n      top: cardHeight * 2,\n      behavior: 'smooth',\n    });\n\n    checkEndOfResults(data.totalHits);\n  } catch (error) {\n    iziToast.error({\n      message:\n        'An error occurred while loading more images. Please try again later.',\n      position: 'topRight',\n    });\n  }\n};\n\nsearchFormEl.addEventListener('submit', onSearchFormSubmit);\nloadMoreBtnEl.addEventListener('click', onLoadMoreBtnClick);\n"],"names":["axios","fetchImages","searchedQuery","page","axiosOptions","createGalleryCardTemplate","largeImageURL","webformatURL","tags","likes","views","comments","downloads","searchFormEl","galleryEl","loader","loadMoreBtnEl","lightbox","SimpleLightbox","currentPage","searchedValue","cardHeight","perPage","renderGallery","images","galleryCardsTemplate","imgDetails","galleryCardEl","checkEndOfResults","totalHits","totalPages","iziToast","onSearchFormSubmit","event","data","onLoadMoreBtnClick"],"mappings":"owBAEAA,EAAM,SAAS,QAAU,2BAElB,MAAMC,EAAc,MAAOC,EAAeC,IAAS,CACxD,MAAMC,EAAe,CACnB,OAAQ,CACN,EAAGF,EACH,WAAY,QACZ,YAAa,aACb,WAAY,GACZ,KAAMC,EACN,SAAU,GACV,IAAK,oCACN,CACL,EAGE,OADiB,MAAMH,EAAM,IAAI,GAAII,CAAY,GACjC,IAClB,ECnBaC,EAA4B,CAAC,CACxC,cAAAC,EACA,aAAAC,EACA,KAAAC,EACA,MAAAC,EACA,MAAAC,EACA,SAAAC,EACA,UAAAC,CACF,IAAM;AAAA;AAAA;AAAA;AAAA,wCAIkCN,CAAa;AAAA,4CACTC,CAAY,UAAUC,CAAI;AAAA;AAAA;AAAA;AAAA,yDAIbC,CAAK;AAAA,yDACLC,CAAK;AAAA,4DACFC,CAAQ;AAAA,6DACPC,CAAS;AAAA;AAAA;AAAA;AAAA,ECfhEC,EAAe,SAAS,cAAc,iBAAiB,EACvDC,EAAY,SAAS,cAAc,aAAa,EAChDC,EAAS,SAAS,cAAc,YAAY,EAC5CC,EAAgB,SAAS,cAAc,cAAc,EAC3D,IAAIC,EAAW,IAAIC,EAAe,gBAAiB,CAAE,aAAc,KAAK,CAAE,EAEtEC,EAAc,EACdC,EAAgB,GAChBC,EAAa,EACjB,MAAMC,EAAU,GAEVC,EAAgBC,GAAU,CAC9B,MAAMC,EAAuBD,EAC1B,IAAIE,GAAcrB,EAA0BqB,CAAU,CAAC,EACvD,KAAK,EAAE,EAEVZ,EAAU,mBAAmB,YAAaW,CAAoB,EAE9D,MAAME,EAAgBb,EAAU,cAAc,IAAI,EAC9Ca,IACFN,EAAaM,EAAc,sBAAuB,EAAC,QAGrDV,EAAS,QAAO,CAClB,EAEMW,EAAoBC,GAAa,CACrC,MAAMC,EAAa,KAAK,KAAKD,EAAYP,CAAO,EAC5CH,GAAeW,GACjBd,EAAc,UAAU,IAAI,WAAW,EACvCe,EAAS,KAAK,CACZ,QAAS,6DACT,SAAU,UAChB,CAAK,GAEDf,EAAc,UAAU,OAAO,WAAW,CAE9C,EAEMgB,EAAqB,MAAMC,GAAS,CACxC,GAAI,CAMF,GALAA,EAAM,eAAc,EAEpBb,EAAgBP,EAAa,SAAS,WAAW,MAAM,KAAI,EAC3DM,EAAc,EAEVC,IAAkB,GAAI,CACxBW,EAAS,MAAM,CACb,MAAO,QACP,QAAS,8BACT,SAAU,UAClB,CAAO,EACD,MACD,CAEDhB,EAAO,UAAU,OAAO,WAAW,EAEnC,MAAMmB,EAAO,MAAMjC,EAAYmB,EAAeD,CAAW,EAEzD,GAAIe,EAAK,KAAK,SAAW,EAAG,CAC1BH,EAAS,MAAM,CACb,QACE,2EACF,SAAU,UAClB,CAAO,EAEDjB,EAAU,UAAY,GACtBD,EAAa,MAAK,EAClBG,EAAc,UAAU,IAAI,WAAW,EACvC,MACD,CAEDF,EAAU,UAAY,GACtBS,EAAcW,EAAK,IAAI,EACvBN,EAAkBM,EAAK,SAAS,CACjC,MAAa,CACZH,EAAS,MAAM,CACb,QACE,mEACF,SAAU,UAChB,CAAK,CACL,QAAY,CACRhB,EAAO,UAAU,IAAI,WAAW,CACjC,CACH,EAEMoB,EAAqB,SAAY,CACrC,GAAI,CACFhB,IAEA,MAAMe,EAAO,MAAMjC,EAAYmB,EAAeD,CAAW,EACzDI,EAAcW,EAAK,IAAI,EAEvB,OAAO,SAAS,CACd,IAAKb,EAAa,EAClB,SAAU,QAChB,CAAK,EAEDO,EAAkBM,EAAK,SAAS,CACjC,MAAe,CACdH,EAAS,MAAM,CACb,QACE,uEACF,SAAU,UAChB,CAAK,CACF,CACH,EAEAlB,EAAa,iBAAiB,SAAUmB,CAAkB,EAC1DhB,EAAc,iBAAiB,QAASmB,CAAkB"}